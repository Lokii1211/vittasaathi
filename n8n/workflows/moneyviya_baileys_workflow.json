{
    "name": "MoneyViya - Complete Financial Assistant (Baileys Bot)",
    "nodes": [
        {
            "parameters": {
                "rule": {
                    "interval": [
                        {
                            "field": "cronExpression",
                            "expression": "0 6 * * *"
                        }
                    ]
                }
            },
            "id": "morning_trigger",
            "name": "Morning 6 AM IST",
            "type": "n8n-nodes-base.scheduleTrigger",
            "typeVersion": 1.1,
            "position": [
                240,
                300
            ],
            "notes": "Trigger morning motivation messages"
        },
        {
            "parameters": {
                "url": "https://moneyviya.up.railway.app/api/v2/users/active",
                "options": {}
            },
            "id": "get_morning_users",
            "name": "Get Active Users",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.1,
            "position": [
                460,
                300
            ]
        },
        {
            "parameters": {
                "jsCode": "// Generate morning motivation message based on user language\nconst users = $input.all();\nconst results = [];\n\nfor (const item of users) {\n  const data = item.json;\n  // If it's an array response, iterate through it\n  const userList = Array.isArray(data) ? data : [data];\n  \n  for (const user of userList) {\n    const lang = user.language || 'en';\n    const name = user.name || 'Friend';\n    const dailyTarget = user.daily_target || 500;\n    const dailyBudget = user.daily_budget || 1000;\n    \n    let message = '';\n    \n    if (lang === 'ta') {\n      message = `‚òÄÔ∏è *‡Æï‡Ææ‡Æ≤‡Øà ‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç, ${name}!*\\n\\nüìä ‡Æá‡Æ©‡Øç‡Æ±‡Øà‡ÆØ ‡Æ§‡Æø‡Æü‡Øç‡Æü‡ÆÆ‡Øç:\\nüí∞ ‡Æ§‡Æø‡Æ©‡Æö‡Æ∞‡Æø ‡Æ™‡Æü‡Øç‡Æú‡ØÜ‡Æü‡Øç: ‚Çπ${dailyBudget}\\nüéØ ‡Æö‡Øá‡ÆÆ‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ØÅ: ‚Çπ${dailyTarget}\\n\\nüí™ ‡Æá‡Æ©‡Øç‡Æ±‡ØÅ ‡Æí‡Æ∞‡ØÅ ‡Æ®‡Æ≤‡Øç‡Æ≤ ‡Æ®‡Ææ‡Æ≥‡Ææ‡Æï ‡Æá‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç!\\n\\n_‡Æö‡ØÜ‡Æ≤‡Æµ‡Øà ‡Æü‡Æø‡Æ∞‡Ææ‡Æï‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ: \"50 ‡Æü‡ØÄ‡Æï‡Øç‡Æï‡ØÅ\" ‡Æé‡Æ© ‡Æü‡Øà‡Æ™‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç_`;\n    } else if (lang === 'hi') {\n      message = `‚òÄÔ∏è *‡§∏‡•Å‡§™‡•ç‡§∞‡§≠‡§æ‡§§, ${name}!*\\n\\nüìä ‡§Ü‡§ú ‡§ï‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ:\\nüí∞ ‡§¶‡•à‡§®‡§ø‡§ï ‡§¨‡§ú‡§ü: ‚Çπ${dailyBudget}\\nüéØ ‡§¨‡§ö‡§§ ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø: ‚Çπ${dailyTarget}\\n\\nüí™ ‡§Ü‡§ú ‡§è‡§ï ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§¶‡§ø‡§® ‡§π‡•ã‡§ó‡§æ!\\n\\n_‡§ñ‡§∞‡•ç‡§ö ‡§ü‡•ç‡§∞‡•à‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è: \"‡§ö‡§æ‡§Ø ‡§™‡§∞ 50\" ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç_`;\n    } else if (lang === 'te') {\n      message = `‚òÄÔ∏è *‡∞∂‡±Å‡∞≠‡±ã‡∞¶‡∞Ø‡∞Ç, ${name}!*\\n\\nüìä ‡∞à‡∞∞‡±ã‡∞ú‡±Å ‡∞™‡±ç‡∞≤‡∞æ‡∞®‡±ç:\\nüí∞ ‡∞∞‡±ã‡∞ú‡±Å‡∞µ‡∞æ‡∞∞‡±Ä ‡∞¨‡∞°‡±ç‡∞ú‡±Ü‡∞ü‡±ç: ‚Çπ${dailyBudget}\\nüéØ ‡∞∏‡±á‡∞µ‡∞ø‡∞Ç‡∞ó‡±ç‡∞∏‡±ç ‡∞≤‡∞ï‡±ç‡∞∑‡±ç‡∞Ø‡∞Ç: ‚Çπ${dailyTarget}\\n\\nüí™ ‡∞à‡∞∞‡±ã‡∞ú‡±Å ‡∞Æ‡∞Ç‡∞ö‡∞ø ‡∞∞‡±ã‡∞ú‡±Å ‡∞Ö‡∞µ‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø!\\n\\n_‡∞ñ‡∞∞‡±ç‡∞ö‡±Å ‡∞ü‡±ç‡∞∞‡∞æ‡∞ï‡±ç ‡∞ö‡±á‡∞Ø‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø: \"‡∞ü‡±Ä‡∞ï‡∞ø 50\" ‡∞ü‡±à‡∞™‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø_`;\n    } else {\n      message = `‚òÄÔ∏è *Good Morning, ${name}!*\\n\\nüìä Today's Plan:\\nüí∞ Daily Budget: ‚Çπ${dailyBudget}\\nüéØ Savings Target: ‚Çπ${dailyTarget}\\n\\nüí™ Today is going to be a great day!\\n\\n_Track expenses by typing: \"Spent 50 on tea\"_`;\n    }\n    \n    results.push({\n      phone: user.phone,\n      message: message\n    });\n  }\n}\n\nreturn results;"
            },
            "id": "generate_morning_msg",
            "name": "Generate Morning Message",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                680,
                300
            ]
        },
        {
            "parameters": {
                "batchSize": 1,
                "options": {}
            },
            "id": "loop_morning",
            "name": "Loop Users Morning",
            "type": "n8n-nodes-base.splitInBatches",
            "typeVersion": 3,
            "position": [
                900,
                300
            ]
        },
        {
            "parameters": {
                "url": "https://moneyviya.up.railway.app/api/baileys/send",
                "sendHeaders": true,
                "headerParameters": {
                    "parameters": [
                        {
                            "name": "Content-Type",
                            "value": "application/json"
                        }
                    ]
                },
                "sendBody": true,
                "specifyBody": "json",
                "jsonBody": "={\n  \"phone\": \"{{ $json.phone }}\",\n  \"message\": \"{{ $json.message }}\"\n}",
                "options": {}
            },
            "id": "send_morning_baileys",
            "name": "Send via Baileys API",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.1,
            "position": [
                1120,
                300
            ],
            "notes": "Calls local Baileys bot API to send message"
        },
        {
            "parameters": {
                "rule": {
                    "interval": [
                        {
                            "field": "cronExpression",
                            "expression": "0 20 * * *"
                        }
                    ]
                }
            },
            "id": "evening_trigger",
            "name": "Evening 8 PM IST",
            "type": "n8n-nodes-base.scheduleTrigger",
            "typeVersion": 1.1,
            "position": [
                240,
                520
            ],
            "notes": "Trigger evening summary messages"
        },
        {
            "parameters": {
                "url": "https://moneyviya.up.railway.app/api/v2/users/active",
                "options": {}
            },
            "id": "get_evening_users",
            "name": "Get Active Users Evening",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.1,
            "position": [
                460,
                520
            ]
        },
        {
            "parameters": {
                "jsCode": "// Generate evening summary based on user language\nconst users = $input.all();\nconst results = [];\n\nfor (const item of users) {\n  const data = item.json;\n  const userList = Array.isArray(data) ? data : [data];\n  \n  for (const user of userList) {\n    const lang = user.language || 'en';\n    const name = user.name || 'Friend';\n    const todayIncome = user.today_income || 0;\n    const todayExpenses = user.today_expenses || 0;\n    const savings = todayIncome - todayExpenses;\n    \n    let message = '';\n    let emoji = savings > 0 ? 'üéâ' : 'üìä';\n    \n    if (lang === 'ta') {\n      message = `üåô *${name}, ‡Æá‡Æ©‡Øç‡Æ±‡Øà‡ÆØ ‡Æö‡ØÅ‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡ÆÆ‡Øç*\\n\\nüíµ ‡Æµ‡Æ∞‡ØÅ‡ÆÆ‡Ææ‡Æ©‡ÆÆ‡Øç: ‚Çπ${todayIncome}\\nüí∏ ‡Æö‡ØÜ‡Æ≤‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç: ‚Çπ${todayExpenses}\\n${emoji} ‡Æ®‡Æø‡Æï‡Æ∞‡ÆÆ‡Øç: ‚Çπ${savings}\\n\\n${savings > 0 ? 'üëè ‡Æ®‡Æ≤‡Øç‡Æ≤ ‡Æµ‡Øá‡Æ≤‡Øà! ‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æö‡Øá‡ÆÆ‡Æø‡Æ§‡Øç‡Æ§‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç!' : 'üí™ ‡Æ®‡Ææ‡Æ≥‡Øà ‡Æö‡Æø‡Æ±‡Æ™‡Øç‡Æ™‡Ææ‡Æï ‡Æá‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç!'}\\n\\n_‡Æ®‡Ææ‡Æ≥‡Øà ‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æ≤‡Ææ‡ÆÆ‡Øç! üòä_`;\n    } else if (lang === 'hi') {\n      message = `üåô *${name}, ‡§Ü‡§ú ‡§ï‡§æ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂*\\n\\nüíµ ‡§Ü‡§Ø: ‚Çπ${todayIncome}\\nüí∏ ‡§ñ‡§∞‡•ç‡§ö: ‚Çπ${todayExpenses}\\n${emoji} ‡§∂‡•Å‡§¶‡•ç‡§ß: ‚Çπ${savings}\\n\\n${savings > 0 ? 'üëè ‡§¨‡§¢‡§º‡§ø‡§Ø‡§æ ‡§ï‡§æ‡§Æ! ‡§Ü‡§™‡§®‡•á ‡§¨‡§ö‡§æ‡§Ø‡§æ!' : 'üí™ ‡§ï‡§≤ ‡§¨‡•á‡§π‡§§‡§∞ ‡§π‡•ã‡§ó‡§æ!'}\\n\\n_‡§ï‡§≤ ‡§Æ‡§ø‡§≤‡§§‡•á ‡§π‡•à‡§Ç! üòä_`;\n    } else if (lang === 'te') {\n      message = `üåô *${name}, ‡∞à‡∞∞‡±ã‡∞ú‡±Å ‡∞∏‡∞æ‡∞∞‡∞æ‡∞Ç‡∞∂‡∞Ç*\\n\\nüíµ ‡∞Ü‡∞¶‡∞æ‡∞Ø‡∞Ç: ‚Çπ${todayIncome}\\nüí∏ ‡∞ñ‡∞∞‡±ç‡∞ö‡±Å‡∞≤‡±Å: ‚Çπ${todayExpenses}\\n${emoji} ‡∞®‡∞ø‡∞ï‡∞∞‡∞Ç: ‚Çπ${savings}\\n\\n${savings > 0 ? 'üëè ‡∞ó‡±ä‡∞™‡±ç‡∞™ ‡∞™‡∞®‡∞ø! ‡∞Æ‡±Ä‡∞∞‡±Å ‡∞Ü‡∞¶‡∞æ ‡∞ö‡±á‡∞∂‡∞æ‡∞∞‡±Å!' : 'üí™ ‡∞∞‡±á‡∞™‡±Å ‡∞Æ‡±Ü‡∞∞‡±Å‡∞ó‡±ç‡∞ó‡∞æ ‡∞â‡∞Ç‡∞ü‡±Å‡∞Ç‡∞¶‡∞ø!'}\\n\\n_‡∞∞‡±á‡∞™‡±Å ‡∞ï‡∞≤‡±Å‡∞¶‡±ç‡∞¶‡∞æ‡∞Ç! üòä_`;\n    } else {\n      message = `üåô *${name}, Today's Summary*\\n\\nüíµ Income: ‚Çπ${todayIncome}\\nüí∏ Expenses: ‚Çπ${todayExpenses}\\n${emoji} Net: ‚Çπ${savings}\\n\\n${savings > 0 ? 'üëè Great job! You saved money!' : 'üí™ Tomorrow will be better!'}\\n\\n_See you tomorrow! üòä_`;\n    }\n    \n    results.push({\n      phone: user.phone,\n      message: message\n    });\n  }\n}\n\nreturn results;"
            },
            "id": "generate_evening_msg",
            "name": "Generate Evening Summary",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                680,
                520
            ]
        },
        {
            "parameters": {
                "batchSize": 1,
                "options": {}
            },
            "id": "loop_evening",
            "name": "Loop Users Evening",
            "type": "n8n-nodes-base.splitInBatches",
            "typeVersion": 3,
            "position": [
                900,
                520
            ]
        },
        {
            "parameters": {
                "url": "https://moneyviya.up.railway.app/api/baileys/send",
                "sendHeaders": true,
                "headerParameters": {
                    "parameters": [
                        {
                            "name": "Content-Type",
                            "value": "application/json"
                        }
                    ]
                },
                "sendBody": true,
                "specifyBody": "json",
                "jsonBody": "={\n  \"phone\": \"{{ $json.phone }}\",\n  \"message\": \"{{ $json.message }}\"\n}",
                "options": {}
            },
            "id": "send_evening_baileys",
            "name": "Send Evening via Baileys",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.1,
            "position": [
                1120,
                520
            ]
        },
        {
            "parameters": {
                "rule": {
                    "interval": [
                        {
                            "field": "cronExpression",
                            "expression": "0 10 * * 0"
                        }
                    ]
                }
            },
            "id": "weekly_trigger",
            "name": "Sunday 10 AM - Weekly",
            "type": "n8n-nodes-base.scheduleTrigger",
            "typeVersion": 1.1,
            "position": [
                240,
                740
            ],
            "notes": "Trigger weekly report on Sundays"
        },
        {
            "parameters": {
                "url": "https://moneyviya.up.railway.app/api/v2/reports/weekly/generate",
                "method": "POST",
                "options": {}
            },
            "id": "generate_weekly_reports",
            "name": "Generate Weekly Reports",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.1,
            "position": [
                460,
                740
            ]
        },
        {
            "parameters": {
                "batchSize": 1,
                "options": {}
            },
            "id": "loop_weekly",
            "name": "Loop Weekly Reports",
            "type": "n8n-nodes-base.splitInBatches",
            "typeVersion": 3,
            "position": [
                680,
                740
            ]
        },
        {
            "parameters": {
                "url": "https://moneyviya.up.railway.app/api/baileys/send",
                "sendHeaders": true,
                "headerParameters": {
                    "parameters": [
                        {
                            "name": "Content-Type",
                            "value": "application/json"
                        }
                    ]
                },
                "sendBody": true,
                "specifyBody": "json",
                "jsonBody": "={\n  \"phone\": \"{{ $json.phone }}\",\n  \"message\": \"{{ $json.report }}\"\n}",
                "options": {}
            },
            "id": "send_weekly_baileys",
            "name": "Send Weekly via Baileys",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.1,
            "position": [
                900,
                740
            ]
        },
        {
            "parameters": {
                "rule": {
                    "interval": [
                        {
                            "field": "hours",
                            "hoursInterval": 1
                        }
                    ]
                }
            },
            "id": "hourly_reminder_check",
            "name": "Hourly Reminder Check",
            "type": "n8n-nodes-base.scheduleTrigger",
            "typeVersion": 1.1,
            "position": [
                240,
                960
            ],
            "notes": "Check for bill reminders every hour"
        },
        {
            "parameters": {
                "url": "https://moneyviya.up.railway.app/api/v2/reminders/pending",
                "options": {}
            },
            "id": "get_reminders",
            "name": "Get Pending Reminders",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.1,
            "position": [
                460,
                960
            ]
        },
        {
            "parameters": {
                "batchSize": 1,
                "options": {}
            },
            "id": "loop_reminders",
            "name": "Loop Reminders",
            "type": "n8n-nodes-base.splitInBatches",
            "typeVersion": 3,
            "position": [
                680,
                960
            ]
        },
        {
            "parameters": {
                "url": "https://moneyviya.up.railway.app/api/baileys/send",
                "sendHeaders": true,
                "headerParameters": {
                    "parameters": [
                        {
                            "name": "Content-Type",
                            "value": "application/json"
                        }
                    ]
                },
                "sendBody": true,
                "specifyBody": "json",
                "jsonBody": "={\n  \"phone\": \"{{ $json.phone }}\",\n  \"message\": \"{{ $json.message }}\"\n}",
                "options": {}
            },
            "id": "send_reminder_baileys",
            "name": "Send Reminder via Baileys",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.1,
            "position": [
                900,
                960
            ]
        }
    ],
    "connections": {
        "Morning 6 AM IST": {
            "main": [
                [
                    {
                        "node": "Get Active Users",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Get Active Users": {
            "main": [
                [
                    {
                        "node": "Generate Morning Message",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Generate Morning Message": {
            "main": [
                [
                    {
                        "node": "Loop Users Morning",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Loop Users Morning": {
            "main": [
                [
                    {
                        "node": "Send via Baileys API",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Evening 8 PM IST": {
            "main": [
                [
                    {
                        "node": "Get Active Users Evening",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Get Active Users Evening": {
            "main": [
                [
                    {
                        "node": "Generate Evening Summary",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Generate Evening Summary": {
            "main": [
                [
                    {
                        "node": "Loop Users Evening",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Loop Users Evening": {
            "main": [
                [
                    {
                        "node": "Send Evening via Baileys",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Sunday 10 AM - Weekly": {
            "main": [
                [
                    {
                        "node": "Generate Weekly Reports",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Generate Weekly Reports": {
            "main": [
                [
                    {
                        "node": "Loop Weekly Reports",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Loop Weekly Reports": {
            "main": [
                [
                    {
                        "node": "Send Weekly via Baileys",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Hourly Reminder Check": {
            "main": [
                [
                    {
                        "node": "Get Pending Reminders",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Get Pending Reminders": {
            "main": [
                [
                    {
                        "node": "Loop Reminders",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Loop Reminders": {
            "main": [
                [
                    {
                        "node": "Send Reminder via Baileys",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        }
    },
    "settings": {
        "executionOrder": "v1"
    },
    "tags": [
        "MoneyViya",
        "Baileys",
        "Financial Assistant",
        "Multilingual"
    ],
    "triggerCount": 4,
    "updatedAt": "2026-01-12T10:45:00.000Z",
    "versionId": "v1.0.0"
}